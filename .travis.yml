language: python
python: 3.7
dist: xenial
sudo: required

install:
  - pip install -r requirements.txt

script:
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then xvfb-run make check; fi
  - make clean
  - python -m pytest --cov-config .coveragerc --cov=delphin_6_automation pytest/

services:
  - mongodb

before_script:
  - mongo mydb_test --eval 'db.createUser({user:"travis",pwd:"test",roles:["readWrite"]});'

after_success:
  - coverage report
  - coveralls